<script type="text/x-template" id="orders-view-template">
    <div class="orders-view">
      <div class="section-header">
        <h2>Órdenes</h2>
        <button class="btn-refresh" @click="refreshData" :disabled="loading">
          {{ loading ? 'Cargando...' : 'Refrescar' }}
        </button>
      </div>
      
      <!-- Tabs Navigation -->
      <div class="modal-tabs">
        <button class="tab-btn" :class="{ active: activeTab === 'active' }" 
                @click="switchTab('active')">
          Órdenes Activas
        </button>
        <button class="tab-btn" :class="{ active: activeTab === 'history' }" 
                @click="switchTab('history')">
          Historial
        </button>
      </div>

      <!-- Tab Content -->
      <div class="orders-tab-content">
        
        <!-- Active Orders Tab -->
        <div v-if="activeTab === 'active'" class="active-orders-tab">
          <div v-if="loading" class="empty-state">Cargando...</div>
          <div v-else-if="activeOrders.length === 0" class="empty-state">
            No hay órdenes activas
          </div>
          <div v-else class="orders-grid">
            <div v-for="order in activeOrders" :key="order.order_id" 
                 class="order-card active-order">
              <div class="order-header">
                <div class="order-info">
                  <div class="table-badge">
                    <i class="fas fa-chair"></i> {{ getTableName(order.table_number) }}
                  </div>
                  <span class="order-time"><i class="far fa-clock"></i> {{ formatTime(order.timestamp) }}</span>
                </div>
              </div>
              
              <div class="order-items-preview">
                <div v-for="(item, index) in order.items" :key="item.item_id" 
                     class="order-item-row">
                  <span class="item-qty">{{ item.quantity }}x</span>
                  <span class="item-name">{{ item.product_name }}</span>
                </div>
              </div>

              <div class="order-footer">
                <div class="order-total-label">Total</div>
                <div class="order-total">S/.{{ order.total.toFixed(2) }}</div>
                <button class="btn-primary btn-full" @click="goToPayment(order)">
                  Cobrar
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- History Tab -->
        <div v-if="activeTab === 'history'" class="history-tab">
          <div v-if="loading" class="empty-state">Cargando...</div>
          <div v-else-if="paidOrders.length === 0" class="empty-state">
            No hay historial de órdenes
          </div>
          <div v-else class="orders-grid">
            <div v-for="order in paidOrders" :key="order.order_id" 
                 class="order-card history-order">
              <div class="order-header">
                <div class="order-info">
                  <div class="order-id-badge">#{{ order.order_id.substring(4, 10) }}</div>
                  <span class="order-time">{{ formatTime(order.timestamp) }}</span>
                </div>
                <div class="status-badge paid">Pagado</div>
              </div>
              
              <div class="payment-summary">
                <div class="payment-row" v-for="payment in order.payments" :key="payment.payment_id">
                  <span>{{ payment.payment_method }}</span>
                  <strong>S/.{{ payment.amount.toFixed(2) }}</strong>
                </div>
              </div>

              <div class="order-footer">
                <div class="order-total-label">Total Pagado</div>
                <div class="order-total">S/.{{ order.total_amount.toFixed(2) }}</div>
              </div>
            </div>
          </div>
        </div>

      </div>
    </div>
  </script>